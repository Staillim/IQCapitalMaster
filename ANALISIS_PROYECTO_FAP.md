# An√°lisis del Proyecto - Fondo de Ahorros y Pr√©stamos "FAP"

**Fecha de An√°lisis:** 8 de octubre de 2025  
**Proyecto:** IQCapital Master - Aplicaci√≥n M√≥vil para FAP  
**Tecnolog√≠a Base:** Next.js 15.3.3 + Firebase + React 18.3.1

---

## üìã Tabla de Contenidos

1. [Estado Actual del Proyecto](#estado-actual-del-proyecto)
2. [Requisitos del Proyecto vs Implementaci√≥n](#requisitos-del-proyecto-vs-implementaci√≥n)
3. [Funcionalidades Implementadas](#funcionalidades-implementadas)
4. [Funcionalidades Faltantes](#funcionalidades-faltantes)
5. [Estructura T√©cnica](#estructura-t√©cnica)
6. [Recomendaciones y Pr√≥ximos Pasos](#recomendaciones-y-pr√≥ximos-pasos)

---

## üéØ Estado Actual del Proyecto

### Resumen Ejecutivo
El proyecto est√° en una fase de **desarrollo temprano-medio (40-50% completado)**. La infraestructura base est√° s√≥lida con autenticaci√≥n, roles de usuario y navegaci√≥n implementados. Sin embargo, faltan m√≥dulos cr√≠ticos del negocio y funcionalidades m√≥viles nativas.

### Stack Tecnol√≥gico Implementado
- **Frontend Framework:** Next.js 15.3.3 (con Turbopack)
- **UI Framework:** React 18.3.1
- **Componentes UI:** Radix UI + Tailwind CSS
- **Backend/Base de Datos:** Firebase (Firestore + Authentication)
- **Validaci√≥n de Formularios:** React Hook Form + Zod
- **Estado Global:** React Context API
- **Iconos:** Lucide React

---

## üìä Requisitos del Proyecto vs Implementaci√≥n

### ‚úÖ Requisitos IMPLEMENTADOS (Completos o Parciales)

#### 1. **Autenticaci√≥n y Registro de Usuarios**
**Estado:** ‚úÖ COMPLETO (100%)

**Implementado:**
- ‚úÖ Registro de usuarios con email y contrase√±a
- ‚úÖ Login con email y contrase√±a
- ‚úÖ Recuperaci√≥n de contrase√±a
- ‚úÖ Validaci√≥n de campos (nombres, email, tel√©fono, contrase√±a)
- ‚úÖ Creaci√≥n autom√°tica de perfil en Firestore al registrarse
- ‚úÖ Almacenamiento de datos de registro en sessionStorage
- ‚úÖ Redirecci√≥n autom√°tica seg√∫n rol de usuario

**Archivos:**
- `src/app/page.tsx` - P√°gina de login
- `src/app/register/page.tsx` - P√°gina de registro
- `src/app/forgot-password/page.tsx` - Recuperaci√≥n de contrase√±a
- `src/firebase/non-blocking-login.tsx` - Funciones de autenticaci√≥n
- `src/firebase/provider.tsx` - Provider de Firebase y creaci√≥n de perfiles

**Pendiente:**
- ‚ùå Validaci√≥n de edad m√≠nima (18 a√±os) en el registro
- ‚ùå Aceptaci√≥n obligatoria de t√©rminos y condiciones en el registro

---

#### 2. **Sistema de Roles y Permisos**
**Estado:** ‚úÖ COMPLETO (95%)

**Implementado:**
- ‚úÖ Tres roles: `cliente`, `asociado`, `admin`
- ‚úÖ Redirecci√≥n autom√°tica seg√∫n rol al dashboard correspondiente
- ‚úÖ Dashboards separados para cada rol:
  - `/dashboard/cliente` - Dashboard de clientes
  - `/dashboard/asociado` - Dashboard de asociados
  - `/dashboard/admin` - Dashboard de administrador
- ‚úÖ Control de acceso basado en rol en las rutas
- ‚úÖ Verificaci√≥n de estado de usuario (`activo`, `inactivo`, `pendiente`)
- ‚úÖ Bypass de verificaci√≥n de estado para admins

**Archivos:**
- `src/app/dashboard/page.tsx` - Redireccionador de dashboard
- `src/app/dashboard/cliente/page.tsx` - Dashboard de clientes
- `src/app/dashboard/asociado/page.tsx` - Dashboard de asociados
- `src/app/dashboard/admin/page.tsx` - Dashboard de administrador
- `firestore.rules` - Reglas de seguridad de Firestore

**Pendiente:**
- ‚ùå Permisos funcionales espec√≠ficos documentados por rol
- ‚ùå Restricciones m√°s granulares dentro de cada dashboard

---

#### 3. **Gesti√≥n de Perfil de Usuario**
**Estado:** ‚úÖ COMPLETO (90%)

**Implementado:**
- ‚úÖ P√°gina dedicada de perfil (`/dashboard/perfil`)
- ‚úÖ Edici√≥n de informaci√≥n b√°sica (nombre, email, tel√©fono, direcci√≥n)
- ‚úÖ Carga de foto de perfil (base64 almacenado en Firestore)
- ‚úÖ Captura de ubicaci√≥n GPS con coordenadas
- ‚úÖ Aceptaci√≥n de t√©rminos y condiciones (post-registro)
- ‚úÖ Configuraci√≥n de notificaciones (email, push, SMS)
- ‚úÖ Cambio de contrase√±a con validaci√≥n
- ‚úÖ Validaci√≥n de email y confirmaci√≥n de contrase√±a
- ‚úÖ Almacenamiento de foto en Firestore (no en Firebase Storage)
- ‚úÖ Folder local creado para futuras fotos (`public/profile-photos/`)

**Archivos:**
- `src/app/dashboard/perfil/page.tsx` - P√°gina principal de perfil
- `src/components/Header.tsx` - Avatar y men√∫ de perfil
- `public/profile-photos/` - Carpeta para almacenamiento local

**Pendiente:**
- ‚ùå Captura de foto con c√°mara del dispositivo (usa input file actualmente)
- ‚ùå Selecci√≥n de imagen desde galer√≠a nativa
- ‚ùå Validaci√≥n de formato de imagen m√°s estricta
- ‚ùå Compresi√≥n de im√°genes antes de guardar

---

#### 4. **Panel de Administraci√≥n**
**Estado:** ‚úÖ PARCIAL (60%)

**Implementado:**
- ‚úÖ Vista de administrador (`/dashboard/admin`)
- ‚úÖ Gesti√≥n de usuarios (`/dashboard/admin/users`):
  - ‚úÖ Listado de todos los usuarios
  - ‚úÖ B√∫squeda de usuarios por nombre/email
  - ‚úÖ Filtrado por rol (cliente, asociado, admin)
  - ‚úÖ Cambio de rol de usuarios
  - ‚úÖ Visualizaci√≥n de estado de usuario
- ‚úÖ Vista de ahorros (`/dashboard/admin/savings`)
- ‚úÖ Vista de pr√©stamos (`/dashboard/admin/loans`)
- ‚úÖ Reglas de seguridad Firestore para admins:
  - ‚úÖ Admins pueden listar todos los usuarios
  - ‚úÖ Admins pueden actualizar perfiles de otros usuarios
  - ‚úÖ Admins pueden eliminar usuarios

**Archivos:**
- `src/app/dashboard/admin/page.tsx` - Dashboard principal de admin
- `src/app/dashboard/admin/users/page.tsx` - Gesti√≥n de usuarios
- `src/app/dashboard/admin/savings/page.tsx` - Gesti√≥n de ahorros
- `src/app/dashboard/admin/loans/page.tsx` - Gesti√≥n de pr√©stamos

**Pendiente:**
- ‚ùå Configuraci√≥n de cuota m√≠nima mensual de ahorro
- ‚ùå Configuraci√≥n de tasas de inter√©s (2% asociados, 2.5% clientes)
- ‚ùå Configuraci√≥n de cuota de manejo anual
- ‚ùå Configuraci√≥n de multas por inasistencia
- ‚ùå Desactivaci√≥n de usuarios (actualmente solo se puede cambiar rol)
- ‚ùå Estad√≠sticas y m√©tricas del fondo

---

#### 5. **Navegaci√≥n y UI**
**Estado:** ‚úÖ COMPLETO (100%)

**Implementado:**
- ‚úÖ Header con avatar, notificaciones y men√∫ de usuario
- ‚úÖ Bottom navigation para m√≥viles
- ‚úÖ Men√∫ lateral para desktop
- ‚úÖ Sistema de notificaciones (toast)
- ‚úÖ Componentes UI reutilizables (Radix UI)
- ‚úÖ Dise√±o responsive (m√≥vil y desktop)
- ‚úÖ Dark mode compatible (Tailwind CSS)
- ‚úÖ Iconos consistentes (Lucide React)

**Archivos:**
- `src/components/Header.tsx` - Header principal
- `src/components/dashboard/BottomNav.tsx` - Navegaci√≥n inferior
- `src/app/dashboard/layout.tsx` - Layout del dashboard
- `src/components/ui/*` - Componentes UI reutilizables

---

### ‚ùå Requisitos NO IMPLEMENTADOS (Faltantes)

#### 1. **M√≥dulo de Ahorros** 
**Estado:** ‚ùå FALTANTE (0%)

**Requerido:**
- ‚ùå Registro de aportes presenciales y virtuales
- ‚ùå Campos: fecha, descripci√≥n, monto, firma digital
- ‚ùå Control de cuota m√≠nima mensual
- ‚ùå Validaci√≥n de montos de ahorro
- ‚ùå Registro de retiros con p√©rdida de ganancias
- ‚ùå Programaci√≥n de retiros con 1 mes de anticipaci√≥n
- ‚ùå Cuota de manejo anual
- ‚ùå Descuento autom√°tico de cuota de ahorro si no se paga
- ‚ùå Validaci√≥n GPS para ahorros presenciales
- ‚ùå Historial de ahorros por usuario

**Estructura Firestore Propuesta:**
```
/users/{userId}/accounts/{accountId}
  - accountType: "savings"
  - balance: number
  - minimumMonthlyContribution: number
  - annualMaintenanceFee: number
  - createdAt: timestamp

/users/{userId}/accounts/{accountId}/transactions/{transactionId}
  - type: "deposit" | "withdrawal"
  - amount: number
  - description: string
  - date: timestamp
  - location: {lat, lng} (optional)
  - signature: string (base64)
  - isPresential: boolean
```

**Archivos a Crear:**
- `src/app/dashboard/ahorros/page.tsx` - Vista principal de ahorros
- `src/app/dashboard/ahorros/nuevo/page.tsx` - Registrar nuevo aporte
- `src/app/dashboard/ahorros/retiro/page.tsx` - Solicitar retiro
- `src/components/dashboard/SavingsForm.tsx` - Formulario de ahorros
- `src/components/dashboard/WithdrawalForm.tsx` - Formulario de retiros

---

#### 2. **M√≥dulo de Pr√©stamos**
**Estado:** ‚ùå FALTANTE (5%)

**P√°ginas Existentes (Vac√≠as):**
- ‚úÖ `src/app/dashboard/prestamos/page.tsx` - Existe pero sin funcionalidad

**Requerido:**
- ‚ùå Solicitud de pr√©stamos (asociados y clientes)
- ‚ùå Aprobaci√≥n de pr√©stamos por asociados
- ‚ùå Sistema de codeudores solidarios
- ‚ùå Control de intereses:
  - 2% para asociados
  - 2.5% para clientes
  - Configuraci√≥n ajustable anualmente por admin
- ‚ùå Registro de abonos (monto + fecha)
- ‚ùå C√°lculo autom√°tico de saldos
- ‚ùå Estados de pr√©stamos (solicitado, aprobado, rechazado, pagado)
- ‚ùå Historial de pr√©stamos por usuario
- ‚ùå Validaci√≥n de capacidad de endeudamiento

**Estructura Firestore Propuesta:**
```
/users/{userId}/accounts/{accountId}/loans/{loanId}
  - loanType: "personal" | "emergency"
  - principalAmount: number
  - interestRate: number
  - totalAmount: number
  - monthlyPayment: number
  - remainingBalance: number
  - status: "requested" | "approved" | "rejected" | "active" | "paid"
  - requestDate: timestamp
  - approvalDate: timestamp
  - codebtorId: string (userId del codeudor)
  - payments: []

/users/{userId}/accounts/{accountId}/loans/{loanId}/payments/{paymentId}
  - amount: number
  - date: timestamp
  - remainingBalance: number
```

**Archivos a Crear:**
- `src/app/dashboard/prestamos/solicitar/page.tsx` - Solicitar pr√©stamo
- `src/app/dashboard/prestamos/aprobar/page.tsx` - Aprobar pr√©stamos (asociados)
- `src/app/dashboard/prestamos/[id]/page.tsx` - Detalle de pr√©stamo
- `src/components/dashboard/LoanRequestForm.tsx` - Formulario de solicitud
- `src/components/dashboard/LoanApprovalForm.tsx` - Formulario de aprobaci√≥n
- `src/components/dashboard/PaymentForm.tsx` - Formulario de abonos

---

#### 3. **M√≥dulo de Reuniones**
**Estado:** ‚ùå FALTANTE (10%)

**P√°ginas Existentes (Vac√≠as):**
- ‚úÖ `src/app/dashboard/reuniones/page.tsx` - Existe pero sin funcionalidad

**Requerido:**
- ‚ùå Programaci√≥n de reuniones (presenciales y virtuales)
- ‚ùå Campos:
  - Fecha y hora
  - Motivo
  - Tipo (presencial/virtual)
  - Ubicaci√≥n (para presenciales)
  - Costo de ingreso (opcional)
  - Enlace de conexi√≥n (para virtuales)
- ‚ùå Notificaciones push de recordatorio
- ‚ùå Registro de asistencia
- ‚ùå Validaci√≥n GPS para reuniones presenciales
- ‚ùå C√°lculo autom√°tico de multas por inasistencia
- ‚ùå Historial de reuniones
- ‚ùå Lista de asistentes

**Estructura Firestore Propuesta:**
```
/meetings/{meetingId}
  - title: string
  - description: string
  - type: "presential" | "virtual"
  - date: timestamp
  - location: {lat, lng, address} (if presential)
  - meetingLink: string (if virtual)
  - entryCost: number (optional)
  - createdBy: userId
  - attendees: []

/meetings/{meetingId}/attendance/{userId}
  - attended: boolean
  - checkInTime: timestamp
  - location: {lat, lng} (if presential)
  - fine: number (if absent)
```

**Archivos a Crear:**
- `src/app/dashboard/reuniones/nueva/page.tsx` - Crear reuni√≥n
- `src/app/dashboard/reuniones/[id]/page.tsx` - Detalle de reuni√≥n
- `src/app/dashboard/reuniones/[id]/asistencia/page.tsx` - Registro de asistencia
- `src/components/dashboard/MeetingForm.tsx` - Formulario de reuniones
- `src/components/dashboard/AttendanceForm.tsx` - Formulario de asistencia

---

#### 4. **M√≥dulo de Reportes y Estados de Cuenta**
**Estado:** ‚ùå FALTANTE (5%)

**P√°ginas Existentes (Vac√≠as):**
- ‚úÖ `src/app/dashboard/reportes/page.tsx` - Existe pero sin funcionalidad

**Requerido:**
- ‚ùå Generaci√≥n autom√°tica de estados de cuenta
- ‚ùå Mostrar:
  - Ahorros totales
  - Retiros realizados
  - Pr√©stamos activos
  - Sanciones/multas
  - Ganancias del per√≠odo
- ‚ùå Reportes gr√°ficos:
  - Gr√°fico de barras
  - Gr√°fico de dona
  - Gr√°fico de l√≠neas
  - Tablas detalladas
- ‚ùå Filtros por per√≠odo (mes, trimestre, a√±o)
- ‚ùå Compartir reportes desde el dispositivo
- ‚ùå Exportar a PDF
- ‚ùå Comparativas entre per√≠odos

**Estructura Firestore Propuesta:**
```
/users/{userId}/statements/{statementId}
  - period: string (e.g., "2025-01")
  - totalSavings: number
  - totalWithdrawals: number
  - activeLoans: number
  - fines: number
  - earnings: number
  - generatedAt: timestamp
```

**Archivos a Crear:**
- `src/app/dashboard/reportes/[period]/page.tsx` - Reporte por per√≠odo
- `src/components/dashboard/AccountStatement.tsx` - Estado de cuenta
- `src/components/dashboard/ReportChart.tsx` - Gr√°ficos
- `src/lib/reportGenerator.ts` - L√≥gica de generaci√≥n de reportes

---

#### 5. **Funcionalidades M√≥viles Nativas**
**Estado:** ‚ùå FALTANTE (20%)

**Parcialmente Implementado:**
- ‚úÖ GPS: Captura de ubicaci√≥n implementada en perfil
- ‚úÖ Notificaciones: Sistema de toast implementado

**Requerido:**
- ‚ùå **C√°mara:**
  - Captura de fotos para perfil (nativo)
  - Captura de documentos
  - Captura de firmas digitales
  - Actualmente usa input file HTML
- ‚ùå **Galer√≠a:**
  - Selecci√≥n de im√°genes desde galer√≠a nativa
  - Actualmente usa input file HTML
- ‚ùå **GPS:**
  - Validaci√≥n de ubicaci√≥n en ahorros presenciales
  - Validaci√≥n de ubicaci√≥n en reuniones presenciales
  - ‚úÖ Ya implementado en perfil
- ‚ùå **Notificaciones Push:**
  - Recordatorios de reuniones
  - Notificaciones de vencimientos de pr√©stamos
  - Alertas de cuotas pendientes
  - Actualmente solo toast en navegador
- ‚ùå **Almacenamiento Local:**
  - Funcionamiento offline
  - Sincronizaci√≥n cuando hay conexi√≥n
  - Cache de datos
- ‚ùå **Escaneo de C√≥digos:**
  - QR para identificaci√≥n r√°pida
  - C√≥digos de barras para pagos
  - Sin implementaci√≥n actual

**Consideraciones:**
- Next.js es principalmente para web, no m√≥vil nativo
- Para funcionalidades m√≥viles nativas se requiere:
  - React Native o Capacitor/Ionic
  - O convertir a PWA con APIs web modernas
  - O usar Capacitor para encapsular Next.js en app nativa

**Alternativas PWA (Progresivas):**
- Usar APIs web modernas:
  - `navigator.mediaDevices.getUserMedia()` para c√°mara
  - `navigator.geolocation` para GPS (‚úÖ ya implementado)
  - Service Workers para offline
  - Web Push API para notificaciones
  - IndexedDB para almacenamiento local

---

#### 6. **Validaciones y Reglas de Negocio**
**Estado:** ‚ùå FALTANTE (30%)

**Parcialmente Implementado:**
- ‚úÖ Validaci√≥n de email y contrase√±a en formularios
- ‚úÖ Validaci√≥n de campos obligatorios

**Requerido:**
- ‚ùå Validaci√≥n de fecha de nacimiento (debe ser mayor a 18 a√±os)
- ‚ùå Validaci√≥n de cuota m√≠nima de ahorro
- ‚ùå C√°lculo autom√°tico de multas por inasistencia
- ‚ùå Validaci√≥n de capacidad de endeudamiento
- ‚ùå Control de anticipaci√≥n de retiros (1 mes)
- ‚ùå Descuento autom√°tico de cuota de manejo
- ‚ùå Validaci√≥n de montos m√°ximos/m√≠nimos
- ‚ùå Control de fechas de vencimiento
- ‚ùå Validaci√≥n de saldos antes de retiros
- ‚ùå Control de per√≠odos de ahorro

**Archivos a Crear:**
- `src/lib/businessRules.ts` - Reglas de negocio centralizadas
- `src/lib/validators.ts` - Validadores personalizados
- `src/lib/calculations.ts` - C√°lculos financieros

---

#### 7. **Datos de Prueba**
**Estado:** ‚ùå FALTANTE (0%)

**Requerido seg√∫n especificaci√≥n:**
- ‚ùå M√≠nimo 20 usuarios de prueba
- ‚ùå M√≠nimo 5 registros por cada m√≥dulo:
  - 5 ahorros
  - 5 retiros
  - 5 pr√©stamos
  - 5 reuniones
  - 5 estados de cuenta

**Archivos a Crear:**
- `scripts/seedDatabase.ts` - Script para poblar la base de datos
- `data/testUsers.json` - Usuarios de prueba
- `data/testData.json` - Datos de prueba por m√≥dulo

**Nota:** Actualmente se eliminaron todos los datos de prueba hardcodeados del frontend.

---

## üèóÔ∏è Estructura T√©cnica

### Arquitectura de Firebase

#### Estructura de Firestore Actual
```
/users/{userId}
  - id: string
  - name: string
  - firstName: string
  - lastName: string
  - email: string
  - phone: string
  - address: string (opcional)
  - photoURL: string (base64)
  - role: "cliente" | "asociado" | "admin"
  - status: "activo" | "inactivo" | "pendiente"
  - registrationDate: timestamp
  - location: {latitude, longitude} (opcional)
  - termsAccepted: boolean (opcional)
  - notifications: {email, push, sms} (opcional)

/users/{userId}/accounts/{accountId}
  - userProfileId: string
  - (otros campos definidos pero no completamente implementados)

/users/{userId}/accounts/{accountId}/transactions/{transactionId}
  - (estructura definida en reglas pero sin implementaci√≥n)

/users/{userId}/accounts/{accountId}/loans/{loanId}
  - (estructura definida en reglas pero sin implementaci√≥n)

/users/{userId}/notifications/{notificationId}
  - (estructura definida en reglas pero sin implementaci√≥n)
```

#### Reglas de Seguridad Firestore
**Archivo:** `firestore.rules`

**Funciones de Seguridad:**
- `isSignedIn()` - Verifica si el usuario est√° autenticado
- `isOwner(userId)` - Verifica si el usuario es due√±o del recurso
- `isExistingOwner(userId)` - Verifica propiedad de documento existente
- `isAdmin()` - Verifica si el usuario tiene rol de admin

**Permisos Implementados:**
- ‚úÖ Usuarios pueden leer/escribir solo sus propios datos
- ‚úÖ Admins pueden listar y gestionar todos los usuarios
- ‚úÖ Validaci√≥n de propiedad en subcollecciones (accounts, loans, transactions)
- ‚úÖ Admins pueden actualizar perfiles de otros usuarios

---

### Arquitectura de Componentes

#### Componentes Principales
```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx (Login)
‚îÇ   ‚îú‚îÄ‚îÄ register/page.tsx (Registro)
‚îÇ   ‚îú‚îÄ‚îÄ forgot-password/page.tsx (Recuperar contrase√±a)
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx (Redirect seg√∫n rol)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx (Layout principal)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cliente/page.tsx (Dashboard cliente)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ asociado/page.tsx (Dashboard asociado)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx (Dashboard admin)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/page.tsx (Gesti√≥n usuarios)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ savings/page.tsx (Gesti√≥n ahorros)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ loans/page.tsx (Gesti√≥n pr√©stamos)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ perfil/page.tsx (Perfil de usuario)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ahorros/page.tsx (‚ö†Ô∏è Vac√≠o)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prestamos/page.tsx (‚ö†Ô∏è Vac√≠o)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reuniones/page.tsx (‚ö†Ô∏è Vac√≠o)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reportes/page.tsx (‚ö†Ô∏è Vac√≠o)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notifications/page.tsx (Notificaciones)
‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx (Root layout)
‚îÇ
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx (Header con avatar y notificaciones)
‚îÇ   ‚îú‚îÄ‚îÄ IQCapitalLogo.tsx (Logo)
‚îÇ   ‚îú‚îÄ‚îÄ FirebaseErrorListener.tsx (Manejo de errores)
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AccountSummaryCard.tsx (Tarjeta resumen)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BottomNav.tsx (Navegaci√≥n inferior)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoanStatus.tsx (Estado de pr√©stamos - sin datos)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TransactionHistory.tsx (Historial - sin datos)
‚îÇ   ‚îî‚îÄ‚îÄ ui/ (42 componentes Radix UI)
‚îÇ
‚îú‚îÄ‚îÄ firebase/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts (Inicializaci√≥n Firebase)
‚îÇ   ‚îú‚îÄ‚îÄ config.ts (Configuraci√≥n)
‚îÇ   ‚îú‚îÄ‚îÄ provider.tsx (Context Provider)
‚îÇ   ‚îú‚îÄ‚îÄ client-provider.tsx (Client wrapper)
‚îÇ   ‚îú‚îÄ‚îÄ non-blocking-login.tsx (Funciones auth)
‚îÇ   ‚îú‚îÄ‚îÄ non-blocking-updates.tsx (Funciones Firestore)
‚îÇ   ‚îú‚îÄ‚îÄ errors.ts (Manejo de errores)
‚îÇ   ‚îú‚îÄ‚îÄ error-emitter.ts (Event emitter)
‚îÇ   ‚îî‚îÄ‚îÄ firestore/
‚îÇ       ‚îú‚îÄ‚îÄ use-collection.tsx (Hook para colecciones)
‚îÇ       ‚îî‚îÄ‚îÄ use-doc.tsx (Hook para documentos)
‚îÇ
‚îî‚îÄ‚îÄ lib/
    ‚îî‚îÄ‚îÄ utils.ts (Utilidades generales)
```

---

### Hooks Personalizados

**Hooks de Firebase:**
- `useFirebase()` - Acceso completo a servicios Firebase
- `useAuth()` - Instancia de Firebase Auth
- `useFirestore()` - Instancia de Firestore
- `useUser()` - Usuario autenticado actual
- `useMemoFirebase()` - Memoizaci√≥n para queries de Firestore
- `useCollection()` - Suscripci√≥n en tiempo real a colecciones
- `useDoc()` - Suscripci√≥n en tiempo real a documentos

**Hooks de UI:**
- `useToast()` - Sistema de notificaciones toast

---

### Sistema de Notificaciones

**Implementado:**
- ‚úÖ Toast notifications (Sonner)
- ‚úÖ Visualizaci√≥n de notificaciones en Header
- ‚úÖ Badge con contador de notificaciones
- ‚úÖ P√°gina de notificaciones (`/dashboard/notifications`)

**Estructura:**
```typescript
interface Notification {
  id: string;
  title: string;
  description: string;
  type: 'info' | 'warning' | 'success' | 'error';
  icon?: string;
  read: boolean;
  createdAt: timestamp;
}
```

**Pendiente:**
- ‚ùå Notificaciones push reales
- ‚ùå Notificaciones por email
- ‚ùå Notificaciones por SMS
- ‚ùå Programaci√≥n de recordatorios
- ‚ùå Notificaciones de vencimientos

---

## üì¶ Dependencias del Proyecto

### Principales
```json
{
  "next": "15.3.3",
  "react": "18.3.1",
  "firebase": "11.2.0",
  "react-hook-form": "7.54.2",
  "zod": "3.24.1",
  "@radix-ui/*": "m√∫ltiples versiones",
  "tailwindcss": "3.4.17",
  "lucide-react": "0.469.0",
  "sonner": "1.7.1"
}
```

### DevDependencies
```json
{
  "typescript": "5.7.3",
  "eslint": "9.18.0",
  "@types/react": "18.3.18"
}
```

---

## üöÄ Recomendaciones y Pr√≥ximos Pasos

### Prioridad ALTA (Cr√≠tico para MVP)

#### 1. **Implementar M√≥dulo de Ahorros** üî¥
**Tiempo estimado:** 2-3 semanas
**Impacto:** ALTO - Es funcionalidad core del negocio

**Tareas:**
- [ ] Dise√±ar estructura de datos en Firestore
- [ ] Crear formulario de registro de aportes
- [ ] Implementar validaci√≥n de cuota m√≠nima
- [ ] Crear vista de historial de ahorros
- [ ] Implementar sistema de retiros
- [ ] A√±adir validaci√≥n GPS para aportes presenciales
- [ ] Implementar captura de firma digital
- [ ] Crear reglas de seguridad Firestore

#### 2. **Implementar M√≥dulo de Pr√©stamos** üî¥
**Tiempo estimado:** 3-4 semanas
**Impacto:** ALTO - Es funcionalidad core del negocio

**Tareas:**
- [ ] Dise√±ar estructura de datos en Firestore
- [ ] Crear formulario de solicitud de pr√©stamos
- [ ] Implementar aprobaci√≥n de pr√©stamos (asociados)
- [ ] Sistema de codeudores solidarios
- [ ] C√°lculo autom√°tico de intereses
- [ ] Formulario de abonos
- [ ] Estados de pr√©stamos
- [ ] Reglas de seguridad Firestore

#### 3. **Validaci√≥n de Edad en Registro** üî¥
**Tiempo estimado:** 1-2 d√≠as
**Impacto:** MEDIO - Requisito legal

**Tareas:**
- [ ] A√±adir campo de fecha de nacimiento en registro
- [ ] Validar edad m√≠nima (18 a√±os)
- [ ] Mostrar error si es menor de edad
- [ ] Actualizar modelo de datos en Firestore

#### 4. **T√©rminos y Condiciones Obligatorios** üî¥
**Tiempo estimado:** 2-3 d√≠as
**Impacto:** MEDIO - Requisito legal

**Tareas:**
- [ ] A√±adir checkbox de t√©rminos en registro
- [ ] Validar aceptaci√≥n obligatoria
- [ ] Crear p√°gina de t√©rminos y condiciones
- [ ] Guardar timestamp de aceptaci√≥n

---

### Prioridad MEDIA (Importante para funcionalidad completa)

#### 5. **Implementar M√≥dulo de Reuniones** üü°
**Tiempo estimado:** 2-3 semanas
**Impacto:** MEDIO-ALTO

**Tareas:**
- [ ] Dise√±ar estructura de datos
- [ ] Formulario de creaci√≥n de reuniones
- [ ] Sistema de asistencia con GPS
- [ ] Notificaciones de recordatorio
- [ ] C√°lculo de multas por inasistencia
- [ ] Vista de reuniones programadas

#### 6. **Implementar M√≥dulo de Reportes** üü°
**Tiempo estimado:** 2-3 semanas
**Impacto:** MEDIO

**Tareas:**
- [ ] Generaci√≥n autom√°tica de estados de cuenta
- [ ] Gr√°ficos (Chart.js o Recharts)
- [ ] Filtros por per√≠odo
- [ ] Exportaci√≥n a PDF
- [ ] Compartir reportes
- [ ] Comparativas entre per√≠odos

#### 7. **Panel de Configuraci√≥n para Admin** üü°
**Tiempo estimado:** 1-2 semanas
**Impacto:** MEDIO

**Tareas:**
- [ ] Configuraci√≥n de cuota m√≠nima mensual
- [ ] Configuraci√≥n de tasas de inter√©s
- [ ] Configuraci√≥n de cuota de manejo anual
- [ ] Configuraci√≥n de multas
- [ ] Configuraci√≥n de par√°metros del sistema

---

### Prioridad BAJA (Mejoras y optimizaciones)

#### 8. **Mejorar Funcionalidades M√≥viles** üü¢
**Tiempo estimado:** 3-4 semanas
**Impacto:** MEDIO (si se mantiene web)

**Opciones:**
1. **PWA (Progressive Web App):**
   - Implementar Service Workers
   - Configurar manifest.json
   - Usar APIs web modernas
   - **Ventaja:** Sin cambios de stack
   - **Desventaja:** Limitaciones en funcionalidades nativas

2. **Capacitor:**
   - Encapsular Next.js en app nativa
   - Acceso a plugins nativos
   - **Ventaja:** Mantiene c√≥digo Next.js
   - **Desventaja:** Requiere configuraci√≥n adicional

3. **React Native:**
   - Reescribir en React Native
   - **Ventaja:** Funcionalidades 100% nativas
   - **Desventaja:** Requiere reescritura completa

**Recomendaci√≥n:** Empezar con PWA, evaluar Capacitor si se necesita m√°s

#### 9. **Poblar Base de Datos de Prueba** üü¢
**Tiempo estimado:** 1 semana
**Impacto:** BAJO (para desarrollo)

**Tareas:**
- [ ] Crear script de seed
- [ ] Generar 20 usuarios de prueba
- [ ] Generar 5 registros por m√≥dulo
- [ ] Documentar usuarios de prueba

#### 10. **Optimizaciones y Refactoring** üü¢
**Tiempo estimado:** Continuo
**Impacto:** BAJO-MEDIO

**Tareas:**
- [ ] Optimizar queries de Firestore
- [ ] Implementar paginaci√≥n
- [ ] Mejorar manejo de errores
- [ ] A√±adir tests unitarios
- [ ] Documentaci√≥n de c√≥digo
- [ ] Performance optimization

---

### Consideraciones T√©cnicas Importantes

#### ‚ö†Ô∏è Limitaciones Actuales

**1. Almacenamiento de Fotos:**
- Actualmente: Base64 en Firestore (l√≠mite 1MB por documento)
- Recomendaci√≥n: Migrar a Firebase Storage para producci√≥n
- Base64 es viable para prototipos, no para escala

**2. Funcionalidades M√≥viles:**
- Next.js es framework web, no m√≥vil nativo
- Algunas funcionalidades requieren app nativa o PWA
- GPS funciona en web, pero c√°mara y notificaciones push son limitadas

**3. Offline:**
- No implementado actualmente
- Firestore tiene soporte offline, pero requiere configuraci√≥n
- Service Workers necesarios para PWA offline

**4. Seguridad:**
- Reglas de Firestore bien implementadas
- Falta implementar rate limiting
- Falta validaci√≥n adicional en el backend (Cloud Functions)

#### üéØ Recomendaciones Arquitect√≥nicas

**1. Cloud Functions (Backend):**
```javascript
// Implementar para:
- C√°lculo autom√°tico de intereses
- Descuento de cuotas de manejo
- Generaci√≥n de estados de cuenta
- Env√≠o de notificaciones
- Validaciones complejas de negocio
```

**2. Firebase Storage:**
```javascript
// Migrar fotos y documentos a Storage
- M√°s escalable que base64
- Mejor rendimiento
- Soporte de transformaciones de imagen
```

**3. Cloud Scheduler:**
```javascript
// Automatizar tareas peri√≥dicas
- Generaci√≥n mensual de estados de cuenta
- Descuento de cuotas
- Recordatorios de pagos
- C√°lculo de multas
```

---

## üìà Roadmap Sugerido

### Fase 1: MVP (M√≠nimo Producto Viable) - 6-8 semanas
- [x] Autenticaci√≥n y registro (COMPLETADO)
- [x] Sistema de roles (COMPLETADO)
- [x] Gesti√≥n de perfil (COMPLETADO)
- [ ] Validaci√≥n de edad y t√©rminos
- [ ] M√≥dulo de ahorros b√°sico
- [ ] M√≥dulo de pr√©stamos b√°sico
- [ ] Panel de administraci√≥n b√°sico

### Fase 2: Funcionalidades Core - 4-6 semanas
- [ ] M√≥dulo de reuniones completo
- [ ] M√≥dulo de reportes completo
- [ ] Sistema de multas autom√°ticas
- [ ] Configuraciones de admin
- [ ] Validaciones de negocio completas

### Fase 3: Mejoras M√≥viles - 3-4 semanas
- [ ] Convertir a PWA
- [ ] Implementar Service Workers
- [ ] Notificaciones push web
- [ ] Funcionamiento offline b√°sico
- [ ] Captura de c√°mara web

### Fase 4: Optimizaci√≥n y Escala - 2-3 semanas
- [ ] Cloud Functions para l√≥gica de negocio
- [ ] Migrar fotos a Firebase Storage
- [ ] Tests automatizados
- [ ] Performance optimization
- [ ] Documentaci√≥n completa

### Fase 5: Producci√≥n - 1-2 semanas
- [ ] Poblar datos de prueba
- [ ] Auditor√≠a de seguridad
- [ ] Testing de usuario
- [ ] Deployment a producci√≥n
- [ ] Monitoreo y analytics

---

## üìä M√©tricas del Proyecto

### Progreso General: ~45%

| M√≥dulo | Completado | Pendiente | Prioridad |
|--------|------------|-----------|-----------|
| Autenticaci√≥n | 100% | 0% | ‚úÖ ALTA |
| Roles y Permisos | 95% | 5% | ‚úÖ ALTA |
| Perfil de Usuario | 90% | 10% | ‚úÖ ALTA |
| Navegaci√≥n y UI | 100% | 0% | ‚úÖ ALTA |
| Panel Admin | 60% | 40% | üî¥ ALTA |
| M√≥dulo Ahorros | 0% | 100% | üî¥ ALTA |
| M√≥dulo Pr√©stamos | 5% | 95% | üî¥ ALTA |
| M√≥dulo Reuniones | 10% | 90% | üü° MEDIA |
| M√≥dulo Reportes | 5% | 95% | üü° MEDIA |
| Funcionalidades M√≥viles | 20% | 80% | üü¢ BAJA |
| Validaciones Negocio | 30% | 70% | üî¥ ALTA |
| Datos de Prueba | 0% | 100% | üü¢ BAJA |

### L√≠neas de C√≥digo (Aproximado)
- **Total de archivos:** ~150
- **Componentes UI:** 42
- **P√°ginas:** ~25
- **Hooks personalizados:** 8
- **Utilidades:** 5+

---

## üîß Scripts de Desarrollo

```bash
# Desarrollo local
npm run dev

# Build para producci√≥n
npm run build

# Iniciar servidor de producci√≥n
npm run start

# Linting
npm run lint
```

---

## üìù Notas Finales

### Fortalezas del Proyecto Actual
‚úÖ Arquitectura s√≥lida con Next.js y Firebase  
‚úÖ Autenticaci√≥n y roles bien implementados  
‚úÖ UI/UX moderna y responsive  
‚úÖ Componentes reutilizables bien organizados  
‚úÖ Reglas de seguridad Firestore robustas  
‚úÖ Hooks personalizados para Firebase  
‚úÖ Sistema de notificaciones funcional  

### √Åreas de Mejora Cr√≠ticas
üî¥ Implementar m√≥dulos core (ahorros, pr√©stamos, reuniones)  
üî¥ A√±adir validaciones de edad y t√©rminos obligatorios  
üî¥ Completar panel de configuraci√≥n de admin  
üî¥ Implementar reglas de negocio autom√°ticas  
üî¥ Mejorar funcionalidades m√≥viles (PWA o nativo)  
üî¥ Poblar base de datos con datos de prueba  

### Decisiones T√©cnicas Pendientes
‚ùì ¬øMantener web o desarrollar app nativa?  
‚ùì ¬øImplementar PWA o usar Capacitor?  
‚ùì ¬øMigrar fotos a Firebase Storage?  
‚ùì ¬øImplementar Cloud Functions para backend?  
‚ùì ¬øCu√°ndo implementar sistema de pagos integrado?  

---

**Documento generado:** 8 de octubre de 2025  
**Pr√≥xima revisi√≥n recomendada:** Cada 2 semanas  
**Contacto:** [Tu informaci√≥n]

---

## üìå Anexos

### Estructura Completa de Archivos
```
IQCapitalMaster-main/
‚îú‚îÄ‚îÄ .next/ (build artifacts)
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ backend.json (esquemas de datos)
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ profile-photos/ (fotos locales)
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ ai/ (Genkit - sin usar actualmente)
‚îÇ   ‚îú‚îÄ‚îÄ app/ (p√°ginas Next.js)
‚îÇ   ‚îú‚îÄ‚îÄ components/ (componentes React)
‚îÇ   ‚îú‚îÄ‚îÄ firebase/ (configuraci√≥n y hooks)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/ (hooks personalizados)
‚îÇ   ‚îî‚îÄ‚îÄ lib/ (utilidades)
‚îú‚îÄ‚îÄ apphosting.yaml
‚îú‚îÄ‚îÄ components.json
‚îú‚îÄ‚îÄ firestore.rules
‚îú‚îÄ‚îÄ next.config.ts
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ postcss.config.mjs
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ tailwind.config.ts
‚îî‚îÄ‚îÄ tsconfig.json
```

### Enlaces √ötiles
- [Documentaci√≥n Next.js](https://nextjs.org/docs)
- [Documentaci√≥n Firebase](https://firebase.google.com/docs)
- [Documentaci√≥n Radix UI](https://www.radix-ui.com/)
- [Documentaci√≥n Tailwind CSS](https://tailwindcss.com/docs)

---

*Este documento est√° sujeto a actualizaciones conforme avance el desarrollo del proyecto.*
